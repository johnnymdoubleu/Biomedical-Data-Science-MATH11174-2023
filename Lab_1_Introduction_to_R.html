<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Johnny MyungWon Lee (Modified from Debby Lipschutz &amp; Stuart McGurnaghan)">
<meta name="dcterms.date" content="2023-01-10">
<title>Lab 1 : Introduction to R and Quarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="Lab_1_Introduction_to_R_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab_1_Introduction_to_R_files/libs/quarto-html/quarto.js"></script>
<script src="Lab_1_Introduction_to_R_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab_1_Introduction_to_R_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab_1_Introduction_to_R_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab_1_Introduction_to_R_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab_1_Introduction_to_R_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab_1_Introduction_to_R_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab_1_Introduction_to_R_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab_1_Introduction_to_R_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
</head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#the-rstudio-ide" id="toc-the-rstudio-ide" class="nav-link active" data-scroll-target="#the-rstudio-ide">1. The RStudio IDE</a>
  <ul class="collapse">
<li><a href="#the-source-pane" id="toc-the-source-pane" class="nav-link" data-scroll-target="#the-source-pane">1.1 The Source Pane</a></li>
  <li>
<a href="#the-console" id="toc-the-console" class="nav-link" data-scroll-target="#the-console">1.2 The Console</a>
  <ul class="collapse">
<li><a href="#exercise-1.1" id="toc-exercise-1.1" class="nav-link" data-scroll-target="#exercise-1.1">Exercise 1.1</a></li>
  </ul>
</li>
  <li>
<a href="#environment-history-files-and-help" id="toc-environment-history-files-and-help" class="nav-link" data-scroll-target="#environment-history-files-and-help">1.3 Environment, History, Files and Help</a>
  <ul class="collapse">
<li><a href="#exercise-1.2" id="toc-exercise-1.2" class="nav-link" data-scroll-target="#exercise-1.2">Exercise 1.2</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting started</a>
  <ul class="collapse">
<li><a href="#quarto-r-markdown" id="toc-quarto-r-markdown" class="nav-link" data-scroll-target="#quarto-r-markdown">2.1 Quarto / R Markdown</a></li>
  <li><a href="#notes-regarding-input" id="toc-notes-regarding-input" class="nav-link" data-scroll-target="#notes-regarding-input">2.2 Notes regarding input</a></li>
  <li>
<a href="#r-functions" id="toc-r-functions" class="nav-link" data-scroll-target="#r-functions">2.3 R functions</a>
  <ul class="collapse">
<li><a href="#exercise-2.1" id="toc-exercise-2.1" class="nav-link" data-scroll-target="#exercise-2.1">Exercise 2.1</a></li>
  </ul>
</li>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">2.4 Packages</a></li>
  </ul>
</li>
  <li>
<a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">3. Vectors</a>
  <ul class="collapse">
<li><a href="#exercise-3.1" id="toc-exercise-3.1" class="nav-link" data-scroll-target="#exercise-3.1">Exercise 3.1</a></li>
  <li><a href="#simple-tabulations" id="toc-simple-tabulations" class="nav-link" data-scroll-target="#simple-tabulations">3.1 Simple tabulations</a></li>
  </ul>
</li>
  <li>
<a href="#basic-functions-and-operators" id="toc-basic-functions-and-operators" class="nav-link" data-scroll-target="#basic-functions-and-operators">4. Basic functions and operators</a>
  <ul class="collapse">
<li><a href="#mathematical-functions" id="toc-mathematical-functions" class="nav-link" data-scroll-target="#mathematical-functions">4.1 Mathematical functions</a></li>
  <li>
<a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">4.2 Descriptive statistics</a>
  <ul class="collapse">
<li><a href="#exercise-4.1" id="toc-exercise-4.1" class="nav-link" data-scroll-target="#exercise-4.1">Exercise 4.1</a></li>
  <li><a href="#exercise-4.2" id="toc-exercise-4.2" class="nav-link" data-scroll-target="#exercise-4.2">Exercise 4.2</a></li>
  <li><a href="#exercise-4.3" id="toc-exercise-4.3" class="nav-link" data-scroll-target="#exercise-4.3">Exercise 4.3</a></li>
  </ul>
</li>
  <li>
<a href="#logical-operators" id="toc-logical-operators" class="nav-link" data-scroll-target="#logical-operators">4.2 Logical operators</a>
  <ul class="collapse">
<li><a href="#exercise-4.4" id="toc-exercise-4.4" class="nav-link" data-scroll-target="#exercise-4.4">Exercise 4.4</a></li>
  <li><a href="#exercise-4.5" id="toc-exercise-4.5" class="nav-link" data-scroll-target="#exercise-4.5">Exercise 4.5</a></li>
  <li><a href="#exercise-4.6" id="toc-exercise-4.6" class="nav-link" data-scroll-target="#exercise-4.6">Exercise 4.6</a></li>
  <li><a href="#exercise-4.7" id="toc-exercise-4.7" class="nav-link" data-scroll-target="#exercise-4.7">Exercise 4.7</a></li>
  </ul>
</li>
  <li>
<a href="#set-operations" id="toc-set-operations" class="nav-link" data-scroll-target="#set-operations">4.3 Set operations</a>
  <ul class="collapse">
<li><a href="#exercise-4.8" id="toc-exercise-4.8" class="nav-link" data-scroll-target="#exercise-4.8">Exercise 4.8</a></li>
  <li><a href="#exercise-4.9" id="toc-exercise-4.9" class="nav-link" data-scroll-target="#exercise-4.9">Exercise 4.9</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#string-operations" id="toc-string-operations" class="nav-link" data-scroll-target="#string-operations">5 String operations</a></li>
  <li>
<a href="#dataframes" id="toc-dataframes" class="nav-link" data-scroll-target="#dataframes">6. Dataframes</a>
  <ul class="collapse">
<li><a href="#exercise-6.1" id="toc-exercise-6.1" class="nav-link" data-scroll-target="#exercise-6.1">Exercise 6.1</a></li>
  <li>
<a href="#subsetting" id="toc-subsetting" class="nav-link" data-scroll-target="#subsetting">6.1 Subsetting</a>
  <ul class="collapse">
<li><a href="#exercise-6.2" id="toc-exercise-6.2" class="nav-link" data-scroll-target="#exercise-6.2">Exercise 6.2</a></li>
  </ul>
</li>
  <li><a href="#creating-a-dataframe" id="toc-creating-a-dataframe" class="nav-link" data-scroll-target="#creating-a-dataframe">6.2 Creating a dataframe</a></li>
  <li><a href="#reading-in-a-dataframe-from-a-file" id="toc-reading-in-a-dataframe-from-a-file" class="nav-link" data-scroll-target="#reading-in-a-dataframe-from-a-file">6.3 Reading in a dataframe from a file</a></li>
  <li>
<a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors">6.4 Factors</a>
  <ul class="collapse">
<li><a href="#exercise-6.3" id="toc-exercise-6.3" class="nav-link" data-scroll-target="#exercise-6.3">Exercise 6.3</a></li>
  <li><a href="#challenge" id="toc-challenge" class="nav-link" data-scroll-target="#challenge">Challenge</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#data-tables" id="toc-data-tables" class="nav-link" data-scroll-target="#data-tables">7 Data Tables</a>
  <ul class="collapse">
<li><a href="#creating-a-data-table" id="toc-creating-a-data-table" class="nav-link" data-scroll-target="#creating-a-data-table">7.1 Creating a data table</a></li>
  <li><a href="#subsetting-1" id="toc-subsetting-1" class="nav-link" data-scroll-target="#subsetting-1">7.2 Subsetting</a></li>
  <li><a href="#column-selection" id="toc-column-selection" class="nav-link" data-scroll-target="#column-selection">7.3 Column selection</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation">7.4 Aggregation</a></li>
  <li><a href="#special-symbols" id="toc-special-symbols" class="nav-link" data-scroll-target="#special-symbols">7.5 Special symbols</a></li>
  <li>
<a href="#chaining-with-pipes" id="toc-chaining-with-pipes" class="nav-link" data-scroll-target="#chaining-with-pipes">7.6 Chaining with pipes</a>
  <ul class="collapse">
<li><a href="#exercise-7.1" id="toc-exercise-7.1" class="nav-link" data-scroll-target="#exercise-7.1">Exercise 7.1</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
</div>
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Lab 1 : Introduction to R and Quarto</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Johnny MyungWon Lee (Modified from Debby Lipschutz &amp; Stuart McGurnaghan) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 10, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header><section id="the-rstudio-ide" class="level1"><h1>1. The RStudio IDE</h1>
<p>The <strong>RStudio(.cloud) IDE</strong> collects four panes onto one window. If you do not see four panes select <code>View &gt; Panes &gt; Show All Panes</code>.</p>
<section id="the-source-pane" class="level2"><h2 class="anchored" data-anchor-id="the-source-pane">1.1 The Source Pane</h2>
<p>Typically the <strong>Source Pane</strong> is in the top right-hand corner. This is the pane you are viewing this file in. This pane is a text editor where you can write a variety of script files (hence the name Source as it would contain your source code). If you hover your mouse over <code>File &gt; New File</code> you will see a list of file-types you can create in this text editor. The most simple type is the R Script. This opens a blank document in which you would type code only. This becomes useful when you start doing more complex programming as you can call and run an entire R Script with a single command. This document type, which contains both text and small chunks of executable code, is called <strong>Quarto</strong> or <strong>R Markdown</strong>. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using Markdown see <strong>section 2.1</strong> of this document or head to <a href="https://quarto.org" class="uri">https://quarto.org</a> and <a href="http://rmarkdown.rstudio.com" class="uri">http://rmarkdown.rstudio.com</a>.</p>
</section><section id="the-console" class="level2"><h2 class="anchored" data-anchor-id="the-console">1.2 The Console</h2>
<p>The <strong>Console pane</strong> is typically below the Source pane and contains 3 tabs, Console, Terminal and Jobs. If you cannot see this pane, go to <code>View &gt; Move Focus to Console</code>. Make sure that the Console tab is showing. This tab allows you to use R in interactive mode by typing individual commands at the command prompt.</p>
<section id="exercise-1.1" class="level3"><h3 class="anchored" data-anchor-id="exercise-1.1">Exercise 1.1</h3>
<p>In the console next to the R command prompt “&gt;” type “3 + 5” and type enter. The answer should appear below it.</p>
</section></section><section id="environment-history-files-and-help" class="level2"><h2 class="anchored" data-anchor-id="environment-history-files-and-help">1.3 Environment, History, Files and Help</h2>
<p>The two panes on the right-hand side contain tabs displaying useful information. You already used the Files tab with the RStudio/RStudio.cloud setup instructions.</p>
<p>The <strong>Help</strong> tab contains useful links with R and RStudio resources you can read for additional information. R and its packages come with help manuals. You can search these directly in the Help tab or you can use the <code>?</code> and <code>??</code> commands from the console. We will look at a manual in more detail once you’ve been introduced to functions. When you first start learning you might want some more general help and want to use your search engine. If you do so, start your question with “R” and be cautious, revert to official sources of information as soon as you have enough information to know where to look.</p>
<p>The <strong>Environment tab</strong> is possibly one of the most useful features of the RStudio IDE. It lists all objects in your environment.</p>
<section id="exercise-1.2" class="level3"><h3 class="anchored" data-anchor-id="exercise-1.2">Exercise 1.2</h3>
<p>Assign the value of <code>3 + 5</code> to the object “an.object” using the assignment operator <code>&lt;-</code>, by typing <code>an.object &lt;- 3 + 5</code>, and press enter. By pressing <code>Alt + "-"</code>, it will automatically generate the assignment operator. Now look under the Environment tab. Create another object called <code>new.object</code> and assign the value <code>an.object</code>. What is the numeric value of <code>new.object</code>? Next, assign the value <code>3</code> to <code>new.object</code> and look under the <strong>Environment tab</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now select the History tab. You should see all the commands you have entered in the console listed there. You can copy any of these commands to the console or the file currently opened in the Source pane by highlighting it and selecting <strong>To Console</strong> or <strong>To Source</strong>, respectively.</p>
</section></section></section><section id="getting-started" class="level1"><h1>2. Getting started</h1>
<section id="quarto-r-markdown" class="level2"><h2 class="anchored" data-anchor-id="quarto-r-markdown">2.1 Quarto / R Markdown</h2>
<p><strong>Quarto</strong> is a new markdown style document which enables you to weave together content and executable code into a finished document. <strong>Quarto</strong> files end in a <code>QMD</code> format whereas <strong>R Markdown</strong> files end in a <code>RMD</code> format. Some of you will be more familiar with <strong>R Markdown</strong> but <strong>Quarto</strong> provides better flexibility where it can combine text with executable code in various languages such as <code>Python</code>.</p>
<p>Hence, you can embed an R code chunk like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>an.object <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>an.object</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
<p>If you click the green arrow on the right-hand side of the code you can run individual code chunks within your document.</p>
<p>When you click the <strong>Render</strong> or <strong>Knit</strong> button, a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. This is very useful for generating reports and you will be expected to submit both assessments as Quarto / R Markdown files.</p>
<p>For now, close the document you generated using <code>Render</code> or <code>Knit</code> and return to the IDE. You may notice that the <strong>Console pane</strong> has been minimised. This is a useful feature as you are now running R in interactive mode from within the Quarto / R Markdown file and you no longer need to view the <strong>Console pane</strong>. Note that the code still runs through the console.</p>
</section><section id="notes-regarding-input" class="level2"><h2 class="anchored" data-anchor-id="notes-regarding-input">2.2 Notes regarding input</h2>
<p>R commands are case sensitive. If you get a function not found error, check spelling and capitalisation.</p>
<p>The <code>#</code> symbol comments out the R code. Run the following chunk with each line muted in turn.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#An.object</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>an.object</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
<p>Spaces have no meaning in R and can be used to make your input easier to read but should not be entered in the middle of an object name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">#new. object  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>new.object <span class="ot">&lt;-</span>    <span class="dv">5</span><span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>new.object</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
<p>Similarly, you might want to split long commands over several lines to make it easier to read. R does not have a special character to continue reading the next line but it will do so if it considers that the command is “incomplete”. A simple way to make sure that all the required lines are read is to surround your command with brackets. R will not stop reading until all the brackets are closed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>an.object <span class="ot">&lt;-</span> ((<span class="dv">5</span> <span class="sc">+</span> new.object) </span>
<span id="cb9-2"><a href="#cb9-2"></a>                              <span class="sc">*</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that if you copy the first line in the console R will issue the continuation prompt <code>+</code> indicating that the command is <strong>incomplete</strong>.</p>
</section><section id="r-functions" class="level2"><h2 class="anchored" data-anchor-id="r-functions">2.3 R functions</h2>
<p>You can call a group of R commands by using a function. The basic form of a function is <code>function.name(arguments, options)</code>. Even if there are no arguments or options, the parentheses are still mandatory. If you leave off the parentheses, R will print out the source code for the function you have entered.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
.Internal(date())
&lt;bytecode: 0x00000219a2fa3578&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sun Jan 15 15:41:11 2023"</code></pre>
</div>
</div>
<section id="exercise-2.1" class="level3"><h3 class="anchored" data-anchor-id="exercise-2.1">Exercise 2.1</h3>
<p>Select the Help tab and type <code>seq</code> in the box with the search symbol (magnifying glass). Read the description and look at the usage. Make a note about anything you find unclear in the user manual format, we will start the lab by checking any questions you have regarding the material up to this point and the user manual in particular.</p>
<p>Arguments and options can be passed by listing them in the order expected by the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="packages" class="level2"><h2 class="anchored" data-anchor-id="packages">2.4 Packages</h2>
<p>At the top left-hand corner of the user manual for the seq function you can see the string <code>seq{base}</code>. This states that the seq function is part of the base package. A package is a collection of functions.</p>
<p>If you select the Packages tab you can see the list of available packages. In order to use the functions in a package you need to load it. If you scroll down the Packages tab you should see that the base and datasets packages are already loaded. You can load additional packages by entering the <code><a href="https://rdrr.io/r/base/library.html">library(packageName)</a></code> command. Alternatively, you can tick the box next to <code>packageName</code> in the <strong>Packages tab</strong>. Note that when you tick the box next to a package, the <code><a href="https://rdrr.io/r/base/library.html">library(packageName)</a></code> command appears in the console.</p>
<p>If you want to use a package that is not listed you must install it first. You can do this by entering the <code>install.packages("packageName")</code> command or selecting <strong>Install</strong> in the <strong>Packages tab</strong>.</p>
</section></section><section id="vectors" class="level1"><h1>3. Vectors</h1>
<p>A vector is about the simplest form for R data objects. In R, even single values are considered vectors. A data vector can be create with the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># a vector containing one element</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>a1 <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># a vector containing four elements</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>a2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">3</span>) </span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># a vector containing the values 1 to 10</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>a3 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> </span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co"># a vector containing 1, 4, 7, 10</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>a4 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">12</span>, <span class="at">by=</span><span class="dv">3</span>) </span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co"># a vector containing two character values</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>a5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fred"</span>, <span class="st">"Ginger"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Elements of a vector can be accessed using the <code>[]</code> operator. Note that indexing starts from <code>1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">38</span>, <span class="dv">12</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">24</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>a[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>a[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22  0 12 23 29 18 16 24</code></pre>
</div>
</div>
<p>The length of a vector can be retrieved by using the function <code><a href="https://rdrr.io/r/base/length.html">length()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">length</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>Accessing a vector beyond its boundary, returns <code>NA</code>, which is the way R codes missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>a[<span class="dv">100</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Note that vectors can only store one type of data at a time. You can inspect the type of data stored by any object in the Environment pane or by using the <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four"</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="fu">class</span>(numbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">class</span>(strings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>You can concatenate vectors, by combining them using the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function. If you concatenate vectors storing different types, they get converted to the most general class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">c</span>(numbers, numbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">c</span>(strings, strings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "one"   "two"   "three" "four"  "one"   "two"   "three" "four" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>mixed <span class="ot">&lt;-</span> <span class="fu">c</span>(numbers, strings)</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">class</span>(mixed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>Vectors can be sorted according to their content.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># rearrange the vector in ascending order</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">sort</span>(strings) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "four"  "one"   "three" "two"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># return indices to rearrange the vector in ascending order</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">order</span>(strings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># same as sort(a)</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>strings[<span class="fu">order</span>(strings)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "four"  "one"   "three" "two"  </code></pre>
</div>
</div>
<section id="exercise-3.1" class="level3"><h3 class="anchored" data-anchor-id="exercise-3.1">Exercise 3.1</h3>
<p>Report sizes of the 10th largest and of the 10th smallest island. The R package <code>datasets</code> is automatically loaded (as you can check from the Packages tab on the right), so the required dataset <code>islands</code> can be accessed directly by calling the dataset by its name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simple-tabulations" class="level2"><h2 class="anchored" data-anchor-id="simple-tabulations">3.1 Simple tabulations</h2>
<p>Given a vector of data, we can summarise its contents in different ways. Let’s look at the <code>discoveries</code> time series, from the built-in datasets package, which counts the number of <strong><em>great</em></strong> discoveries per year:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>discoveries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = 1860 
End = 1959 
Frequency = 1 
  [1]  5  3  0  2  0  3  2  3  6  1  2  1  2  1  3  3  3  5  2  4  4  0  2  3  7
 [26] 12  3 10  9  2  3  7  7  2  3  3  6  2  4  3  5  2  2  4  0  4  2  5  2  3
 [51]  3  6  5  8  3  6  6  0  5  2  2  2  6  3  4  4  2  2  4  7  5  3  3  0  2
 [76]  2  2  1  3  4  2  2  1  1  1  2  1  4  4  3  2  1  4  1  1  1  0  0  2  0</code></pre>
</div>
</div>
<p>This dataset is quite short but looking at the entire dataset would not be a good idea for anything longer. We can get a feel for the distribution of a dataset with the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function which displays descriptive statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">summary</span>(discoveries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     2.0     3.0     3.1     4.0    12.0 </code></pre>
</div>
</div>
<p>The set of unique elements can be found with <code><a href="https://rdrr.io/r/base/unique.html">unique()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">unique</span>(discoveries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  5  3  0  2  6  1  4  7 12 10  9  8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(discoveries))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0  1  2  3  4  5  6  7  8  9 10 12</code></pre>
</div>
</div>
<p>We could also tabulate the vector, that is count the number of occurrences of each element in the vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">table</span>(discoveries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>discoveries
 0  1  2  3  4  5  6  7  8  9 10 12 
 9 12 26 20 12  7  6  4  1  1  1  1 </code></pre>
</div>
</div>
<p>Most continuous data is hard to tabulate directly. You can categorise observations into bins by using the <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">#Display just the first few lines of the built-in rivers dataset</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">head</span>(rivers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 735 320 325 392 524 450</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4000</span>, <span class="at">by =</span> <span class="dv">1000</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">table</span>(<span class="fu">cut</span>(rivers, bins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    (0,1e+03] (1e+03,2e+03] (2e+03,3e+03] (3e+03,4e+03] 
          125            12             3             1 </code></pre>
</div>
</div>
<p>We can get better labels, by allowing more digits:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">table</span>(<span class="fu">cut</span>(rivers, bins, <span class="at">dig.lab =</span> <span class="dv">4</span>)) <span class="co"># see ?cut for more details</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   (0,1000] (1000,2000] (2000,3000] (3000,4000] 
        125          12           3           1 </code></pre>
</div>
</div>
<p>We can get a visual representation of the distribution by creating a histogram of our data using <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">hist</span>(rivers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lab_1_Introduction_to_R_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The breaks in the dataset are automatically computed by R and they offer a good starting point. We can always force the breaks in the histogram to get a more tailored view of our dataset. Let’s also add better labels (options <code>xlab</code> and <code>ylab</code>) and title (option <code>main</code>) to the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4000</span>, <span class="at">by =</span> <span class="dv">250</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">hist</span>(rivers, <span class="at">breaks =</span> bins,</span>
<span id="cb58-3"><a href="#cb58-3"></a>     <span class="at">main =</span> <span class="st">"Distribution of river lengths"</span>,      </span>
<span id="cb58-4"><a href="#cb58-4"></a>     <span class="at">xlab =</span> <span class="st">"Length in miles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lab_1_Introduction_to_R_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="basic-functions-and-operators" class="level1"><h1>4. Basic functions and operators</h1>
<p>The standard mathematical operations are available <code>("+", "-", "*", "/", "ˆ")</code> and they respect the common precedence rules. To change the order in which operations are performed, use parentheses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="dv">7</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">3</span><span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>(<span class="dv">7</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>((<span class="dv">7</span> <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 225</code></pre>
</div>
</div>
<p>Other less commonly used mathematical operators are <code>%/%</code> for integer division and <code>%%</code> for modulus (which returns the remainder after integer division).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="dv">7</span> <span class="sc">%/%</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="dv">7</span> <span class="sc">%%</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<section id="mathematical-functions" class="level2"><h2 class="anchored" data-anchor-id="mathematical-functions">4.1 Mathematical functions</h2>
<p>Here are some built-in mathematical functions in R:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> summation</li>
<li>
<code><a href="https://rdrr.io/r/base/MathFun.html">sqrt()</a></code> square root</li>
<li>
<code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code> exponential</li>
<li>
<code><a href="https://rdrr.io/r/base/Log.html">log()</a></code> natural log</li>
<li>
<code><a href="https://rdrr.io/r/base/Log.html">log10()</a></code> base-10 logs</li>
<li>
<code><a href="https://rdrr.io/r/base/MathFun.html">abs()</a></code> absolute value</li>
<li>
<code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> maximum value</li>
<li>
<code><a href="https://rdrr.io/r/base/Trig.html">sin()</a></code> and all the other trig functions</li>
</ul>
<p>All these functions (and many others in R) are vectorised: this means that applying the function to a vector, applies it to each element in the vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">36</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="fu">sqrt</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4 5 6</code></pre>
</div>
</div>
<p>Note that the order of operations is important!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">sum</span>(discoveries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 310</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">sum</span>(discoveries)<span class="sc">^</span><span class="dv">2</span> <span class="co"># first elements are summed, then squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">sum</span>(discoveries<span class="sc">^</span><span class="dv">2</span>) <span class="co"># first elements are squared, then summed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1464</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a></span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="fu">sum</span>(x) <span class="sc">*</span> <span class="fu">sum</span>(y) <span class="co"># product of the sums</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="co"># sum of the crossproducts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75</code></pre>
</div>
</div>
</section><section id="descriptive-statistics" class="level2"><h2 class="anchored" data-anchor-id="descriptive-statistics">4.2 Descriptive statistics</h2>
<p>Many statistical functions are defined too:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">length</span>(rivers) <span class="co"># sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 141</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">median</span>(rivers) <span class="co"># sample median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 425</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">mean</span>(rivers) <span class="co"># sample mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 591.1844</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">range</span>(rivers) <span class="co"># minimum and maximum values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  135 3710</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">var</span>(rivers) <span class="co"># sample variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 243908.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">sd</span>(rivers) <span class="co"># sample standard deviation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 493.8708</code></pre>
</div>
</div>
<p>Quantiles corresponding to the given probabilities can be obtained with the <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">quantile</span>(rivers, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)) <span class="co"># interquartile range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25% 75% 
310 680 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">quantile</span>(rivers) <span class="co"># default output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 135  310  425  680 3710 </code></pre>
</div>
</div>
<section id="exercise-4.1" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.1">Exercise 4.1</h3>
<p>Create a vector called <code>islands3</code> which includes only <code>islands</code>, from the built-in <code>islands</code> dataset, with area divisible by 3 and report its median and interquartile range.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correlations between pairs of vectors can be computed with the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>) <span class="co">#100 normally distributed random numbers</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb98-3"><a href="#cb98-3"></a><span class="fu">plot</span>(x, y) <span class="co"># scatter plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lab_1_Introduction_to_R_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="fu">cor</span>(x, y) <span class="co"># Pearson's r is the default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.04322711</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="co"># Spearman rho</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.03066307</code></pre>
</div>
</div>
<p>Note that your numbers will be different as they depend on the seed of the random number generator. To make sure that you will get exactly the same sequence of random numbers, you need to set a seed explicitly using <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code>. This is very important for reproducibility of results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">rnorm</span>(<span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.53277180  1.93309788 -0.57090067  0.09665849  0.38225680</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">rnorm</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.2044115  0.6001619  1.0679751  0.9778573 -0.7446721</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">set.seed</span>(<span class="dv">5467</span>)</span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="fu">rnorm</span>(<span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1243918 -0.4178659  0.7043420  0.8113636 -0.9740301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">set.seed</span>(<span class="dv">5467</span>)</span>
<span id="cb109-2"><a href="#cb109-2"></a><span class="fu">rnorm</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1243918 -0.4178659  0.7043420  0.8113636 -0.9740301</code></pre>
</div>
</div>
</section><section id="exercise-4.2" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.2">Exercise 4.2</h3>
<p>Compute mean and standard deviation of the <code>rivers</code> vector, and use them to create a new vector called <code>randomrivers</code> (of the same length as <code>rivers</code>) of normally distributed points according to those parameters (set the random seed to 1 beforehand).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In reporting results, we generally do not need more than 2-3 decimal places. This can be achieved using either <code><a href="https://rdrr.io/r/base/Round.html">signif()</a></code> or <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="fu">signif</span>(<span class="fl">1234.56789</span>, <span class="dv">3</span>) <span class="co"># keep only 3 significant digits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1230</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="fu">signif</span>(<span class="fl">0.123456</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.123</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="fu">round</span>(<span class="fl">1234.56789</span>, <span class="dv">3</span>) <span class="co"># keep only 3 decimal places</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1234.568</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="fu">round</span>(<span class="fl">0.123456</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.123</code></pre>
</div>
</div>
</section><section id="exercise-4.3" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.3">Exercise 4.3</h3>
<p>Using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function create a scatter plot of <code>rivers</code> and <code>randomrivers</code> and report the Pearson’s correlation coefficient between the two vectors at 3 significant digits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What can be said about the distribution of rivers? In what way could we investigate this?</p>
</section></section><section id="logical-operators" class="level2"><h2 class="anchored" data-anchor-id="logical-operators">4.2 Logical operators</h2>
<p>Logical operators return values of logical type (either <code>TRUE</code> or <code>FALSE</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a><span class="co"># equal</span></span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="co"># not equal</span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">!=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># greater or equal (also &gt;, &lt; and &lt;= exist)</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">&gt;=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="co"># negation</span></span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="sc">!</span><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE</code></pre>
</div>
</div>
<p>Note that <code>TRUE</code> statements have value <code>1</code> and <code>FALSE</code> <code>0</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="fu">sum</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<section id="exercise-4.4" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.4">Exercise 4.4</h3>
<p>Count how many elements in <code>randomrivers</code> are negative and how many values in <code>randomrivers</code> are more than double than their corresponding element in <code>rivers</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exercise-4.5" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.5">Exercise 4.5</h3>
<p>Count how many islands, from the <code>islands</code> dataset, have an odd area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A function that is often used with logical variables is <code><a href="https://rdrr.io/r/base/which.html">which()</a></code>, whose function is to return the indices of the <code>TRUE</code> values. This is very useful, for example, to determine which elements satisfy a given condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="fu">which</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">&gt;=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3</code></pre>
</div>
</div>
</section><section id="exercise-4.6" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.6">Exercise 4.6</h3>
<p>Using the built-in <code>rivers</code> dataset, report minimum and maximum river lengths and their index in the vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exercise-4.7" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.7">Exercise 4.7</h3>
<p>Report names and sizes of islands, from the built-in <code>islands</code> dataset, with area in the first quartile, and compute the median area in this subset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are two versions of the <code>OR</code> <code>(|, ||)</code> and <code>AND</code> <code>(&amp;, &amp;&amp;)</code> operators. For vectors, you often want to apply the operator to each pair of elements in the vectors, and thus obtain a vector as result: in this case use the element-wise operators <code>|</code> and <code>&amp;</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>) <span class="sc">|</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="co"># logical OR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>) <span class="sc">&amp;</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="co"># logical AND</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The double version applies the operation only to objects of length <code>1</code>, so it will produce only one element as result. This is most commonly used when checking for conditions in <code>if</code> statements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>(<span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">||</span> (<span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>(<span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> (<span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Note that if you use the double operator with a vector, only the first element will be checked, which in most cases is not what you want!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>) <span class="sc">&amp;&amp;</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in c(TRUE, TRUE, FALSE) &amp;&amp; c(TRUE, FALSE, FALSE): 'length(x) = 3 &gt; 1' in
coercion to 'logical(1)'

Warning in c(TRUE, TRUE, FALSE) &amp;&amp; c(TRUE, FALSE, FALSE): 'length(x) = 3 &gt; 1' in
coercion to 'logical(1)'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="co"># only the first element is checked!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>) <span class="sc">&amp;&amp;</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in c(TRUE, TRUE, FALSE) &amp;&amp; c(FALSE, FALSE, FALSE): 'length(x) = 3 &gt; 1'
in coercion to 'logical(1)'

Warning in c(TRUE, TRUE, FALSE) &amp;&amp; c(FALSE, FALSE, FALSE): 'length(x) = 3 &gt; 1'
in coercion to 'logical(1)'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>In some cases (such as when testing for a condition in an <code>if</code> statement) we may want to perform an element-wise logical test, but still return just one value. That’s where <code><a href="https://rdrr.io/r/base/all.html">all()</a></code> and <code>any(</code>) can be of help.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a><span class="co"># all tests must be TRUE for the result to be TRUE</span></span>
<span id="cb154-2"><a href="#cb154-2"></a><span class="fu">all</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a><span class="fu">all</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1"></a><span class="co"># at least one test must be TRUE for the result to be TRUE</span></span>
<span id="cb158-2"><a href="#cb158-2"></a><span class="fu">any</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a><span class="fu">any</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">%in%</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section></section><section id="set-operations" class="level2"><h2 class="anchored" data-anchor-id="set-operations">4.3 Set operations</h2>
<p>A very common task is to join two sets: this may mean appending the elements of one to the other, or creating the union of the two, or limiting the result to the intersection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a>first6months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>)</span>
<span id="cb162-2"><a href="#cb162-2"></a>months<span class="fl">.31</span>day <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Mar"</span>, <span class="st">"May"</span>, <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Oct"</span>, <span class="st">"Dec"</span>)</span>
<span id="cb162-3"><a href="#cb162-3"></a></span>
<span id="cb162-4"><a href="#cb162-4"></a><span class="co"># concatenation of the two sets</span></span>
<span id="cb162-5"><a href="#cb162-5"></a><span class="fu">c</span>(first6months, months<span class="fl">.31</span>day) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jan" "Mar" "May" "Jul" "Aug" "Oct"
[13] "Dec"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a><span class="co"># elements present in either set</span></span>
<span id="cb164-2"><a href="#cb164-2"></a><span class="fu">union</span>(first6months, months<span class="fl">.31</span>day) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Oct" "Dec"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a><span class="co"># elements present in both sets</span></span>
<span id="cb166-2"><a href="#cb166-2"></a><span class="fu">intersect</span>(first6months, months<span class="fl">.31</span>day) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jan" "Mar" "May"</code></pre>
</div>
</div>
<p>The <code><a href="https://rdrr.io/r/base/sets.html">setdiff()</a></code> function allows to remove elements from a set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a><span class="co"># elements not in the second set</span></span>
<span id="cb168-2"><a href="#cb168-2"></a><span class="fu">setdiff</span>(first6months, months<span class="fl">.31</span>day) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Feb" "Apr" "Jun"</code></pre>
</div>
</div>
<section id="exercise-4.8" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.8">Exercise 4.8</h3>
<p>Plot a histogram of all integers between 1 and the maximum river length that do not appear in the rivers vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A very useful operator is <code>%in%</code>, which tests if the elements in the first set are present in the second set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>first6months <span class="sc">%in%</span> months<span class="fl">.31</span>day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>) <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE  TRUE FALSE</code></pre>
</div>
</div>
</section><section id="exercise-4.9" class="level3"><h3 class="anchored" data-anchor-id="exercise-4.9">Exercise 4.9</h3>
<p>Report the smallest area in <code>islands3</code> that is also present in the rivers vector, and for the areas in <code>islands3</code> that are not present in rivers report the mean rounded to the first decimal place. What goes wrong when trying to answer the second question with the function <code><a href="https://rdrr.io/r/base/sets.html">setdiff()</a></code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="string-operations" class="level1"><h1>5 String operations</h1>
<p>It is very common to have to deal with strings, in R these are objects of class character.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a>a1 <span class="ot">&lt;-</span> <span class="st">"First string"</span></span>
<span id="cb176-2"><a href="#cb176-2"></a>a2 <span class="ot">&lt;-</span> <span class="st">"Another string"</span></span>
<span id="cb176-3"><a href="#cb176-3"></a>a3 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1, a2, <span class="st">"String"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To join two or more strings into one, use the function <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>. You can use option <code>sep</code> to specify what separator should be inserted between each pairs of strings (by default it’s a space). The shortcut <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, where the default is no space, is also available.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a><span class="fu">paste</span>(a1, a2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First string Another string"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a><span class="fu">paste</span>(a1, a2, <span class="at">sep =</span> <span class="st">""</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First stringAnother string"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a><span class="co"># equivalent to paste0(a1, a2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="fu">paste</span>(a1, a2, <span class="at">sep =</span> <span class="st">" - "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First string - Another string"</code></pre>
</div>
</div>
<p>The same function can be used to append the same text to a vector of strings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a><span class="fu">paste</span>(a3, <span class="st">"example"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First string example"   "Another string example" "String example"        </code></pre>
</div>
</div>
<p>Sometimes we may want to check if a specific pattern is present in a string (or a vector of strings). The function <code><a href="https://rdrr.io/r/base/grep.html">grep()</a></code> allows for that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a><span class="co"># return indices of matches</span></span>
<span id="cb186-2"><a href="#cb186-2"></a><span class="fu">grep</span>(<span class="st">"string"</span>, a3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a><span class="co"># ignore differences in capitalization</span></span>
<span id="cb188-2"><a href="#cb188-2"></a><span class="fu">grep</span>(<span class="st">"string"</span>, a3, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a><span class="co"># return content of matched elements</span></span>
<span id="cb190-2"><a href="#cb190-2"></a><span class="fu">grep</span>(<span class="st">"A"</span>, a3, <span class="at">value =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Another string"</code></pre>
</div>
</div>
<p>The function <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> substitutes part of a string with something else.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a><span class="fu">gsub</span>(<span class="st">"Another"</span>, <span class="st">"One other"</span>, a2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "One other string"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1"></a><span class="fu">gsub</span>(<span class="st">"string"</span>, <span class="st">"example"</span>, a2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Another example"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a><span class="fu">gsub</span>(<span class="st">"data"</span>, <span class="st">"data science"</span>, a2) <span class="co"># no match, the string is left unchanged</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Another string"</code></pre>
</div>
</div>
<p>For more advanced matches or substitutions, you may need to learn about regular expressions, which are ways of constructing rules to capture a specific pattern in a string. Here are some basic examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a>us.states <span class="ot">&lt;-</span> <span class="fu">rownames</span>(USArrests)</span>
<span id="cb198-2"><a href="#cb198-2"></a><span class="fu">grep</span>(<span class="st">"Ca"</span>, us.states, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "California"     "North Carolina" "South Carolina"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a><span class="fu">grep</span>(<span class="st">"^Ca"</span>, us.states, <span class="at">value =</span> <span class="cn">TRUE</span>) <span class="co"># match only at the start of a string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "California"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a><span class="fu">grep</span>(<span class="st">"ing"</span>, us.states, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Washington" "Wyoming"   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="fu">grep</span>(<span class="st">"ing$"</span>, us.states, <span class="at">value =</span> <span class="cn">TRUE</span>) <span class="co"># match only at the end of a string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wyoming"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a><span class="fu">grep</span>(<span class="st">"Ma"</span>, us.states, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Maine"         "Maryland"      "Massachusetts"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1"></a><span class="fu">grep</span>(<span class="st">"Ma.*nd"</span>, us.states, <span class="at">value =</span> <span class="cn">TRUE</span>) <span class="co"># match any character repeated any number of times</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Maryland"</code></pre>
</div>
</div>
<p>Some other useful functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1"></a><span class="fu">nchar</span>(a3) <span class="co"># string length</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12 14  6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1"></a><span class="fu">toupper</span>(a3) <span class="co"># convert to uppercase</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FIRST STRING"   "ANOTHER STRING" "STRING"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a><span class="fu">tolower</span>(a3) <span class="co"># convert to lowercase</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "first string"   "another string" "string"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a><span class="co"># Again, note that none of these actually change a3 in memory, unless we run, e.g., a3 &lt;- tolower(a3).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="dataframes" class="level1"><h1>6. Dataframes</h1>
<p>The dataframe is the primary data structure in R. This is a table in which the columns are variables and the rows are observations. While this resembles a matrix, matrices are less commonly used in R, as (just like vectors) they can only contain one class of values. A dataframe instead can contain a mix of categorical and numerical variables.</p>
<p>Lets examine the <code>USArrests</code> built-in dataframe, which lists the number of arrests in 1973 per 100,000 population in each state for murder, assault, and rape, and it also gives the percentage of the population living in urban areas within the state.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a><span class="co"># show the first 6 lines of the dataframe</span></span>
<span id="cb217-2"><a href="#cb217-2"></a><span class="fu">head</span>(USArrests) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Murder Assault UrbanPop Rape
Alabama      13.2     236       58 21.2
Alaska       10.0     263       48 44.5
Arizona       8.1     294       80 31.0
Arkansas      8.8     190       50 19.5
California    9.0     276       91 40.6
Colorado      7.9     204       78 38.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="fu">tail</span>(USArrests, <span class="at">n =</span> <span class="dv">10</span>) <span class="co"># show the last 10 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Murder Assault UrbanPop Rape
South Dakota     3.8      86       45 12.8
Tennessee       13.2     188       59 26.9
Texas           12.7     201       80 25.5
Utah             3.2     120       80 22.9
Vermont          2.2      48       32 11.2
Virginia         8.5     156       63 20.7
Washington       4.0     145       73 26.2
West Virginia    5.7      81       39  9.3
Wisconsin        2.6      53       66 10.8
Wyoming          6.8     161       60 15.6</code></pre>
</div>
</div>
<p>Let’s find out how big this dataframe is in terms of number of rows and columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a><span class="fu">dim</span>(USArrests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a><span class="fu">nrow</span>(USArrests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a><span class="fu">ncol</span>(USArrests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Note that this does not count the column headers and row names. To see the names of the columns (the variable name) and of the rows use <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code> and <code><a href="https://rdrr.io/r/base/colnames.html">rownames()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a><span class="fu">colnames</span>(USArrests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Murder"   "Assault"  "UrbanPop" "Rape"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a><span class="fu">rownames</span>(USArrests)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Alabama"        "Alaska"         "Arizona"        "Arkansas"      
 [5] "California"     "Colorado"       "Connecticut"    "Delaware"      
 [9] "Florida"        "Georgia"        "Hawaii"         "Idaho"         
[13] "Illinois"       "Indiana"        "Iowa"           "Kansas"        
[17] "Kentucky"       "Louisiana"      "Maine"          "Maryland"      
[21] "Massachusetts"  "Michigan"       "Minnesota"      "Mississippi"   
[25] "Missouri"       "Montana"        "Nebraska"       "Nevada"        
[29] "New Hampshire"  "New Jersey"     "New Mexico"     "New York"      
[33] "North Carolina" "North Dakota"   "Ohio"           "Oklahoma"      
[37] "Oregon"         "Pennsylvania"   "Rhode Island"   "South Carolina"
[41] "South Dakota"   "Tennessee"      "Texas"          "Utah"          
[45] "Vermont"        "Virginia"       "Washington"     "West Virginia" 
[49] "Wisconsin"      "Wyoming"       </code></pre>
</div>
</div>
<p>If the dataframe is an object in your environment, as it would be if you create a dataset or read it in, it would appear under the <strong>Data</strong> section of the <strong>Environment pane</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a>df.USArrests <span class="ot">&lt;-</span> USArrests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Click on the triangle to the left of <code>df.USArrests</code> and you should see column names, data types and the first few values of each column.</p>
<p>Every entry in this table-like structure is indexed by two numbers, the row number and the column number. You can also refer to the values in the dataframe by row name and column name (if these exist).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1"></a>USArrests[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1"></a>USArrests[<span class="st">"Idaho"</span>, <span class="st">"UrbanPop"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
</div>
<p>The easiest way to work with the variables in the dataframe is to use the <code>$</code> operator. Note that each column of a dataframe is effectively a vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1"></a><span class="fu">head</span>(USArrests<span class="sc">$</span>Murder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.2 10.0  8.1  8.8  9.0  7.9</code></pre>
</div>
</div>
<section id="exercise-6.1" class="level3"><h3 class="anchored" data-anchor-id="exercise-6.1">Exercise 6.1</h3>
<p>Using the built-in attitude dataframe, report the median, range and interquartile range for the <code>rating</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="subsetting" class="level2"><h2 class="anchored" data-anchor-id="subsetting">6.1 Subsetting</h2>
<p>Dataframes can be subset using the <code>[]</code> operator the following way: <code>dataframe.name[required rows/observations, required columns/variables]</code>. We may want only a fraction of the observations but all columns: in this case, list which observations (by name or by index) are needed, and leave the column blank.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>USArrests[<span class="st">"Pennsylvania"</span>, ] <span class="co"># make sure you include the comma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Murder Assault UrbanPop Rape
Pennsylvania    6.3     106       72 14.9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>USArrests[<span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>, ] <span class="co"># once again, the comma must be there</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Murder Assault UrbanPop Rape
Georgia    17.4     211       60 25.8
Hawaii      5.3      46       83 20.2
Idaho       2.6     120       54 14.2
Illinois   10.4     249       83 24.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>USArrests[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">44</span>,<span class="dv">50</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Murder Assault UrbanPop Rape
Arizona    8.1     294       80 31.0
Utah       3.2     120       80 22.9
Wyoming    6.8     161       60 15.6</code></pre>
</div>
</div>
<p>The thing to pay close attention to is the comma after the row index inside the brackets. The comma followed by a blank column index tells R you want to see the entire row (all columns).</p>
<p>If you want to see all rows for some given columns, leave a blank space before the column indices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a><span class="fu">head</span>(USArrests[, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Assault UrbanPop
Alabama        236       58
Alaska         263       48
Arizona        294       80
Arkansas       190       50
California     276       91
Colorado       204       78</code></pre>
</div>
</div>
<p>Note that when you extract a single column, what you get is just a vector by default. If you want to keep it formatted as a dataframe, you need to disable the drop option.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a><span class="fu">head</span>(USArrests[, <span class="st">"UrbanPop"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 58 48 80 50 91 78</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a><span class="fu">head</span>(USArrests[, <span class="st">"UrbanPop"</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           UrbanPop
Alabama          58
Alaska           48
Arizona          80
Arkansas         50
California       91
Colorado         78</code></pre>
</div>
</div>
<p>It is also possible to discard some rows and columns by negating their indices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a>USArrests[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">48</span>), <span class="sc">-</span><span class="dv">3</span>] <span class="co"># skip a bunch of rows and the third column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Murder Assault Rape
Alabama     13.2     236 21.2
Alaska      10.0     263 44.5
Arizona      8.1     294 31.0
Arkansas     8.8     190 19.5
Wisconsin    2.6      53 10.8
Wyoming      6.8     161 15.6</code></pre>
</div>
</div>
<p>Suppose you want to see only rows for which the murder rate is greater than 15. You can accomplish this either by using some of the operations on dataframes we have already seen, or by using the <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> function. However, the <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> function can have unpredictable results in some circumstances and is best avoided.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a>USArrests[USArrests<span class="sc">$</span>Murder <span class="sc">&gt;</span> <span class="dv">15</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Murder Assault UrbanPop Rape
Florida       15.4     335       80 31.9
Georgia       17.4     211       60 25.8
Louisiana     15.4     249       66 22.2
Mississippi   16.1     259       44 17.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1"></a><span class="fu">subset</span>(USArrests, Murder <span class="sc">&gt;</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Murder Assault UrbanPop Rape
Florida       15.4     335       80 31.9
Georgia       17.4     211       60 25.8
Louisiana     15.4     249       66 22.2
Mississippi   16.1     259       44 17.1</code></pre>
</div>
</div>
<p>A convenient function when dealing with operations on several columns of a dataframe is <code><a href="https://rdrr.io/r/base/with.html">with()</a></code>, which allows to use column names directly without needing to use <code>$</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1"></a><span class="fu">with</span>(USArrests, <span class="fu">max</span>(Murder <span class="sc">+</span> Rape)) <span class="co"># same as max(USArrests$Murder + USArrests$Rape)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 58.2</code></pre>
</div>
</div>
<section id="exercise-6.2" class="level3"><h3 class="anchored" data-anchor-id="exercise-6.2">Exercise 6.2</h3>
<p>Report the median rating for observations that have above median values for the <code>raises</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="creating-a-dataframe" class="level2"><h2 class="anchored" data-anchor-id="creating-a-dataframe">6.2 Creating a dataframe</h2>
<p>Dataframes can be created by aggregating existing vectors (all must be of the same length) into one single object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1"></a>pat.id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p01"</span>, <span class="st">"p02"</span>, <span class="st">"p03"</span>, <span class="st">"p04"</span>, <span class="st">"p05"</span>, <span class="st">"p06"</span>, <span class="st">"p07"</span>)</span>
<span id="cb260-2"><a href="#cb260-2"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">58</span>, <span class="dv">33</span>, <span class="dv">47</span>, <span class="dv">42</span>, <span class="dv">61</span>, <span class="dv">49</span>, <span class="dv">65</span>)</span>
<span id="cb260-3"><a href="#cb260-3"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">178</span>, <span class="dv">167</span>, <span class="dv">169</span>, <span class="dv">172</span>, <span class="dv">158</span>, <span class="dv">175</span>, <span class="dv">164</span>)</span>
<span id="cb260-4"><a href="#cb260-4"></a>myData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pat.id, age, height)</span>
<span id="cb260-5"><a href="#cb260-5"></a>myData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pat.id age height
1    p01  58    178
2    p02  33    167
3    p03  47    169
4    p04  42    172
5    p05  61    158
6    p06  49    175
7    p07  65    164</code></pre>
</div>
</div>
<p>Columns can be appended to an existing dataframe with <code><a href="https://rdrr.io/r/base/cbind.html">cbind()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1"></a>myData <span class="ot">&lt;-</span> <span class="fu">cbind</span>(myData,</span>
<span id="cb262-2"><a href="#cb262-2"></a>          <span class="at">sex =</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>),</span>
<span id="cb262-3"><a href="#cb262-3"></a>          <span class="fu">c</span>(<span class="fl">0.328</span>, <span class="fl">0.340</span>, <span class="fl">0.235</span>, <span class="fl">0.293</span>, <span class="fl">0.281</span>, <span class="fl">0.412</span>, <span class="fl">0.304</span>))</span>
<span id="cb262-4"><a href="#cb262-4"></a>myData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pat.id age height sex c(0.328, 0.34, 0.235, 0.293, 0.281, 0.412, 0.304)
1    p01  58    178   F                                             0.328
2    p02  33    167   F                                             0.340
3    p03  47    169   M                                             0.235
4    p04  42    172   F                                             0.293
5    p05  61    158   M                                             0.281
6    p06  49    175   M                                             0.412
7    p07  65    164   F                                             0.304</code></pre>
</div>
</div>
<p>Note that since we did not specify a name for the last column, R created one by default, but we can modify it to something more sensible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1"></a><span class="fu">colnames</span>(myData)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">"hdl"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Another way of adding a column to a dataframe is by using the <code>$</code> operator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1"></a>myData<span class="sc">$</span>randomvalues <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(myData))</span>
<span id="cb265-2"><a href="#cb265-2"></a>myData<span class="sc">$</span>constant <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># the same value is fills the whole column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1"></a>myData<span class="sc">$</span>randomvalues <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># to remove a column</span></span>
<span id="cb266-2"><a href="#cb266-2"></a>myData<span class="sc">$</span>constant <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is possible to append rows using <code><a href="https://rdrr.io/r/base/cbind.html">rbind()</a></code>, but we cannot simply pass a vector to append, as each column in the dataframe may be of a different class, and vectors can store only one class of objects at a time. So we have to create a temporary dataframe to store the row that we want to append. Note that the dataframes must have exactly the same column names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1"></a>myData <span class="ot">&lt;-</span> <span class="fu">rbind</span>(myData,</span>
<span id="cb267-2"><a href="#cb267-2"></a>          <span class="fu">data.frame</span>(<span class="at">pat.id=</span><span class="st">"p08"</span>, <span class="at">age=</span><span class="dv">39</span>,</span>
<span id="cb267-3"><a href="#cb267-3"></a>          <span class="at">height=</span><span class="dv">174</span>, <span class="at">sex=</span><span class="st">"M"</span>, <span class="at">hdl=</span><span class="fl">0.388</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="reading-in-a-dataframe-from-a-file" class="level2"><h2 class="anchored" data-anchor-id="reading-in-a-dataframe-from-a-file">6.3 Reading in a dataframe from a file</h2>
<p>Large data files can be generated in a number of ways but to be read easily they should have one column per variable, a header for each column is useful but can be added afterwards, one row per observation, and nothing else. The same character should separate all the columns and occur nowhere else in the document. Standard characters to separate columns are comma separated (CSV) and tab separated (TSV) format. Any data file created in this way can be read using the generic <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function (see documentation in the Help tab).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1"></a>diab00 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/diab00.txt"</span>, <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">stringsAsFactors =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CSV files are easily generated using spreadsheet software such as Excel and can be opened in Excel by people who are unfamiliar with R. It is therefore very useful in multidisciplinary teams. The <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> function is a version of the more generic <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function with the options preset for a standard CSV file. Similarly, a tab-separated file can be read into a dataframe with the <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1"></a>diab00 <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"data/diab00.txt"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="factors" class="level2"><h2 class="anchored" data-anchor-id="factors">6.4 Factors</h2>
<p>Factors look like character strings, but they are internally represented as integers, one for each level. Unless you set the <code>stringsAsFactors</code> option to <code>FALSE</code>, factor variables are created automatically when a dataframe is read with <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code> or <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> if a column contains entries that cannot be coerced to a specific type (say <code>numerical</code> or <code>Dat</code>). Note that it’s not possible to add a new level to an existing factor variable: R will set it to <code>NA</code>. It is therefore preferable to always read data in with the <code>stringsAsFactors</code> option set to <code>FALSE</code> and then convert variables to factors as and when required.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1"></a>colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"brown"</span>, <span class="st">"blonde"</span>)</span>
<span id="cb270-2"><a href="#cb270-2"></a>freqs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">18</span>)</span>
<span id="cb270-3"><a href="#cb270-3"></a><span class="co"># repeat each colour by the given frequency</span></span>
<span id="cb270-4"><a href="#cb270-4"></a>hair.colour <span class="ot">&lt;-</span> <span class="fu">rep</span>(colours, freqs) </span>
<span id="cb270-5"><a href="#cb270-5"></a>hair.colour <span class="ot">&lt;-</span> <span class="fu">factor</span>(hair.colour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A barplot is a simple way of plotting the frequency of a categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(hair.colour), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"white"</span>)) <span class="co"># colours are recycled</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lab_1_Introduction_to_R_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(hair.colour), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"yellow"</span>, <span class="st">"brown"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lab_1_Introduction_to_R_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="exercise-6.3" class="level3"><h3 class="anchored" data-anchor-id="exercise-6.3">Exercise 6.3</h3>
<p>Produce a histogram and a box-plot of the <code>rating</code> variable of the attitude dataframe side by side. You will need to first specify <code>par(mfrow=c(1,2))</code> to tell R that you want your image to contain one row and two columns. Assign correct axis labels as well as plot titles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="challenge" class="level3"><h3 class="anchored" data-anchor-id="challenge">Challenge</h3>
<p>Extending on exercise 6.3, create a function and apply it to all the columns of the attitude dataframe to create correctly labeled histograms and boxplots, side-by-side, for each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="data-tables" class="level1"><h1>7 Data Tables</h1>
<p>The data.table is a high performance enhancement to the data.frame. As an extension of the dataframe, the data.table provides all the benefits, but with higher memory efficiency, extremely fast aggregation, updates and joins with a simplified syntax. Data tables are defined with the <code>data.table()</code> function. Existing dataframes are compatible and can be converted by passing the dataframe to the data.table function. Likewise, the data table object may be converted back to a dataframe using the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>. You can also convert existing unnamed list, data frame of data table by reference using <code>setDT</code>. Data tables can be expressed with the notation: <code>DT[i, j, by]</code>. This is pronounced take <code>DT</code>, subset rows using <code>i</code>, then calculate <code>j</code> grouped by <code>by</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb275-2"><a href="#cb275-2"></a>mtcars.dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(mtcars)</span>
<span id="cb275-3"><a href="#cb275-3"></a><span class="fu">head</span>(mtcars.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    mpg cyl disp  hp drat    wt  qsec vs am gear carb
1: 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
2: 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
3: 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
4: 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
5: 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
6: 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>As data tables do not support row names, it’s often sensible to keep the <code>rownames</code> as a column using the <code>keep.rownames</code> option.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a>mtcars.dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(mtcars, <span class="at">keep.rownames =</span> <span class="cn">TRUE</span>) <span class="co"># Defaults the rowname to "rn"</span></span>
<span id="cb277-2"><a href="#cb277-2"></a><span class="fu">head</span>(mtcars.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  rn  mpg cyl disp  hp drat    wt  qsec vs am gear carb
1:         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
2:     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
3:        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
4:    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
5: Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
6:           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>The <code>rownames</code> default name can be overwritten by supplying the name you prefer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a>mtcars.dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(mtcars, <span class="at">keep.rownames =</span> <span class="st">"models"</span>) <span class="co"># Names the rowname</span></span>
<span id="cb279-2"><a href="#cb279-2"></a><span class="fu">head</span>(mtcars.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              models  mpg cyl disp  hp drat    wt  qsec vs am gear carb
1:         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
2:     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
3:        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
4:    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
5: Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
6:           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<section id="creating-a-data-table" class="level2"><h2 class="anchored" data-anchor-id="creating-a-data-table">7.1 Creating a data table</h2>
<p>Data tables are very efficient, especially when dealing with many millions of rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">1971</span> <span class="co"># Select an arbitrary number to seed the random number generator (RNG)</span></span>
<span id="cb281-2"><a href="#cb281-2"></a>sample.size <span class="ot">&lt;-</span> <span class="dv">500000</span></span>
<span id="cb281-3"><a href="#cb281-3"></a><span class="fu">set.seed</span>(seed) <span class="co"># Note: To ensure consistent results, the RNG must be seeded before each function call </span></span>
<span id="cb281-4"><a href="#cb281-4"></a>diabetes.dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb281-5"><a href="#cb281-5"></a>  <span class="at">pat.id =</span> <span class="dv">1</span><span class="sc">:</span>sample.size,</span>
<span id="cb281-6"><a href="#cb281-6"></a>  <span class="at">dm.type =</span> <span class="fu">sample</span>(</span>
<span id="cb281-7"><a href="#cb281-7"></a>      <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), sample.size, <span class="at">replace=</span><span class="cn">TRUE</span>, </span>
<span id="cb281-8"><a href="#cb281-8"></a>      <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)), </span>
<span id="cb281-9"><a href="#cb281-9"></a>  <span class="at">sex =</span> <span class="fu">sample</span>(</span>
<span id="cb281-10"><a href="#cb281-10"></a>      <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), sample.size, <span class="at">replace=</span><span class="cn">TRUE</span>, </span>
<span id="cb281-11"><a href="#cb281-11"></a>      <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.33</span>,<span class="fl">0.67</span>)), </span>
<span id="cb281-12"><a href="#cb281-12"></a>  <span class="at">hba1c.mmol =</span> <span class="fu">rbeta</span>(sample.size, <span class="dv">25</span>, <span class="dv">9</span>)<span class="sc">*</span><span class="dv">110</span> )</span>
<span id="cb281-13"><a href="#cb281-13"></a></span>
<span id="cb281-14"><a href="#cb281-14"></a><span class="fu">head</span>(diabetes.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id dm.type sex hba1c.mmol
1:      1       2   1   88.97589
2:      2       2   2   81.40640
3:      3       2   2   82.64720
4:      4       2   2   95.16112
5:      5       2   1   90.75763
6:      6       2   2   90.60751</code></pre>
</div>
</div>
</section><section id="subsetting-1" class="level2"><h2 class="anchored" data-anchor-id="subsetting-1">7.2 Subsetting</h2>
<p>As a reminder, <code>DT[i, j, by]</code> is pronounced take <code>DT</code>, subset rows using <code>i</code>, then calculate <code>j</code> grouped by <code>by</code>. Here we use subsetting to create derivative data tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1"></a>mtcars.dt <span class="ot">&lt;-</span>  <span class="fu">data.table</span>(mtcars, <span class="at">keep.rownames=</span><span class="st">"models"</span>)</span>
<span id="cb283-2"><a href="#cb283-2"></a></span>
<span id="cb283-3"><a href="#cb283-3"></a>mpg.gt30.dt <span class="ot">&lt;-</span> mtcars.dt[mpg <span class="sc">&gt;</span> <span class="dv">30</span>]</span>
<span id="cb283-4"><a href="#cb283-4"></a></span>
<span id="cb283-5"><a href="#cb283-5"></a>cyl<span class="fl">.4</span>and8.dt <span class="ot">&lt;-</span> mtcars.dt[cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>)]</span>
<span id="cb283-6"><a href="#cb283-6"></a></span>
<span id="cb283-7"><a href="#cb283-7"></a>cyl.excl4and8.dt <span class="ot">&lt;-</span> mtcars.dt[<span class="sc">!</span>cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>)]</span>
<span id="cb283-8"><a href="#cb283-8"></a></span>
<span id="cb283-9"><a href="#cb283-9"></a>merc.models.dt <span class="ot">&lt;-</span> mtcars.dt[<span class="fu">grepl</span>(<span class="st">"Merc"</span>,models)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="column-selection" class="level2"><h2 class="anchored" data-anchor-id="column-selection">7.3 Column selection</h2>
<p>Columns may be referenced by name or position. There are many possible ways to manipulate column selection a few are detailed here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1"></a><span class="co"># List column names explicitly</span></span>
<span id="cb284-2"><a href="#cb284-2"></a><span class="fu">head</span>(diabetes.dt[, dm.type,sex])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sex dm.type
1:   1       2
2:   1       2
3:   1       2
4:   1       2
5:   1       2
6:   1       2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1"></a><span class="co"># Return all columns in the range</span></span>
<span id="cb286-2"><a href="#cb286-2"></a><span class="fu">head</span>(diabetes.dt[, dm.type<span class="sc">:</span>hba1c.mmol])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex hba1c.mmol
1:       2   1   88.97589
2:       2   2   81.40640
3:       2   2   82.64720
4:       2   2   95.16112
5:       2   1   90.75763
6:       2   2   90.60751</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1"></a><span class="co"># Excluding a column</span></span>
<span id="cb288-2"><a href="#cb288-2"></a><span class="fu">head</span>(diabetes.dt[, <span class="sc">!</span><span class="st">"dm.type"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id sex hba1c.mmol
1:      1   1   88.97589
2:      2   2   81.40640
3:      3   2   82.64720
4:      4   2   95.16112
5:      5   1   90.75763
6:      6   2   90.60751</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1"></a><span class="co"># Excluding multiple columns</span></span>
<span id="cb290-2"><a href="#cb290-2"></a><span class="fu">head</span>(diabetes.dt[, <span class="sc">!</span><span class="fu">c</span>(<span class="st">"dm.type"</span>,<span class="st">"hba1c.mmol"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id sex
1:      1   1
2:      2   2
3:      3   2
4:      4   2
5:      5   1
6:      6   2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1"></a><span class="co"># Excluding a range </span></span>
<span id="cb292-2"><a href="#cb292-2"></a><span class="fu">head</span>(diabetes.dt[, <span class="sc">!</span>(dm.type<span class="sc">:</span>hba1c.mmol)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id
1:      1
2:      2
3:      3
4:      4
5:      5
6:      6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a>my.columns <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"dm.type"</span>,<span class="st">"sex"</span>) </span>
<span id="cb294-2"><a href="#cb294-2"></a></span>
<span id="cb294-3"><a href="#cb294-3"></a><span class="co"># The .. (double dot) look up one level in the environment</span></span>
<span id="cb294-4"><a href="#cb294-4"></a><span class="fu">head</span>(diabetes.dt[, ..my.columns])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex
1:       2   1
2:       2   2
3:       2   2
4:       2   2
5:       2   1
6:       2   2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a><span class="co"># Excluding based on character vector</span></span>
<span id="cb296-2"><a href="#cb296-2"></a><span class="fu">head</span>(diabetes.dt[, <span class="sc">!</span>..my.columns])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id hba1c.mmol
1:      1   88.97589
2:      2   81.40640
3:      3   82.64720
4:      4   95.16112
5:      5   90.75763
6:      6   90.60751</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1"></a><span class="co"># Selects fixed column position </span></span>
<span id="cb298-2"><a href="#cb298-2"></a><span class="fu">head</span>(diabetes.dt[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex
1:       2   1
2:       2   2
3:       2   2
4:       2   2
5:       2   1
6:       2   2</code></pre>
</div>
</div>
<p>The summary command provides min, max, interquartile range, median and mean. Providing <code>by = list(dm.type, sex)</code> aggregates the data and applies the summary function to each group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1"></a>diabetes.summary <span class="ot">&lt;-</span> diabetes.dt[, </span>
<span id="cb300-2"><a href="#cb300-2"></a>                    <span class="fu">as.list</span>(<span class="fu">summary</span>(hba1c.mmol)),  </span>
<span id="cb300-3"><a href="#cb300-3"></a>                    by<span class="ot">=</span><span class="fu">list</span>(dm.type, sex)]</span>
<span id="cb300-4"><a href="#cb300-4"></a></span>
<span id="cb300-5"><a href="#cb300-5"></a>diabetes.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
1:       2   1 39.25293 75.57212 81.42169 80.88870 86.73704 105.2156
2:       2   2 39.06357 75.52357 81.40246 80.87598 86.74822 107.0541
3:       1   2 41.13940 75.60472 81.38569 80.85342 86.70759 104.9365
4:       1   1 40.04755 75.66419 81.40252 80.89027 86.65041 105.5992</code></pre>
</div>
</div>
<p>To create new columns with the summary values in the original dataframe instead, you can use the command <code>names(summary(c(1, 1)))</code> to return a character array of column names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1"></a>diabetes.dt[, <span class="fu">names</span>(<span class="fu">summary</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))) <span class="sc">:</span><span class="er">=</span> </span>
<span id="cb302-2"><a href="#cb302-2"></a>                  <span class="fu">as.list</span>(<span class="fu">summary</span>(hba1c.mmol)),  </span>
<span id="cb302-3"><a href="#cb302-3"></a>            by<span class="ot">=</span><span class="fu">list</span>(dm.type, sex)] </span>
<span id="cb302-4"><a href="#cb302-4"></a></span>
<span id="cb302-5"><a href="#cb302-5"></a><span class="fu">head</span>(diabetes.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id dm.type sex hba1c.mmol     Min.  1st Qu.   Median     Mean  3rd Qu.
1:      1       2   1   88.97589 39.25293 75.57212 81.42169 80.88870 86.73704
2:      2       2   2   81.40640 39.06357 75.52357 81.40246 80.87598 86.74822
3:      3       2   2   82.64720 39.06357 75.52357 81.40246 80.87598 86.74822
4:      4       2   2   95.16112 39.06357 75.52357 81.40246 80.87598 86.74822
5:      5       2   1   90.75763 39.25293 75.57212 81.42169 80.88870 86.73704
6:      6       2   2   90.60751 39.06357 75.52357 81.40246 80.87598 86.74822
       Max.
1: 105.2156
2: 107.0541
3: 107.0541
4: 107.0541
5: 105.2156
6: 107.0541</code></pre>
</div>
</div>
<p>The list function may be used inside the data table to modify column content and column names. This is often useful when merging tables where some column names may clash.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1"></a><span class="co"># Rename a column name</span></span>
<span id="cb304-2"><a href="#cb304-2"></a>diabetes.dt[, <span class="fu">list</span>(<span class="at">diabetes.type =</span> dm.type,sex)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        diabetes.type sex
     1:             2   1
     2:             2   2
     3:             2   2
     4:             2   2
     5:             2   1
    ---                  
499996:             2   1
499997:             2   2
499998:             2   2
499999:             2   2
500000:             2   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1"></a><span class="fu">head</span>(diabetes.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id dm.type sex hba1c.mmol     Min.  1st Qu.   Median     Mean  3rd Qu.
1:      1       2   1   88.97589 39.25293 75.57212 81.42169 80.88870 86.73704
2:      2       2   2   81.40640 39.06357 75.52357 81.40246 80.87598 86.74822
3:      3       2   2   82.64720 39.06357 75.52357 81.40246 80.87598 86.74822
4:      4       2   2   95.16112 39.06357 75.52357 81.40246 80.87598 86.74822
5:      5       2   1   90.75763 39.25293 75.57212 81.42169 80.88870 86.73704
6:      6       2   2   90.60751 39.06357 75.52357 81.40246 80.87598 86.74822
       Max.
1: 105.2156
2: 107.0541
3: 107.0541
4: 107.0541
5: 105.2156
6: 107.0541</code></pre>
</div>
</div>
<p>Note that you can use a <code>.</code> as an alias of the list command. It was not used earlier to avoid confusion while introducing the concept of piping.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1"></a>manuf.info.dt <span class="ot">&lt;-</span> mtcars.dt[, </span>
<span id="cb308-2"><a href="#cb308-2"></a>                    .(<span class="at">manufacturer =</span> </span>
<span id="cb308-3"><a href="#cb308-3"></a>                          <span class="fu">gsub</span>(<span class="st">" .*"</span>, <span class="st">""</span>, models))]</span>
<span id="cb308-4"><a href="#cb308-4"></a><span class="fu">head</span>(manuf.info.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   manufacturer
1:        Mazda
2:        Mazda
3:       Datsun
4:       Hornet
5:       Hornet
6:      Valiant</code></pre>
</div>
</div>
</section><section id="aggregation" class="level2"><h2 class="anchored" data-anchor-id="aggregation">7.4 Aggregation</h2>
<p>Since the data table takes the form <code>DT[i, j, by]</code>, the calculation of <code>j</code> can be aggregated. In the following example, the mean <code>hba1c.mmol</code> value is calculated for the whole group. Since there are two possible <code>dm.type</code> values in the group, each <code>dm.type</code> mean is calculated and the result applied to each row accordingly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1"></a>diabetes.dt[, hba1c.mmol.mean <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>(hba1c.mmol), by<span class="ot">=</span>dm.type]</span>
<span id="cb310-2"><a href="#cb310-2"></a></span>
<span id="cb310-3"><a href="#cb310-3"></a><span class="fu">head</span>(diabetes.dt) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id dm.type sex hba1c.mmol     Min.  1st Qu.   Median     Mean  3rd Qu.
1:      1       2   1   88.97589 39.25293 75.57212 81.42169 80.88870 86.73704
2:      2       2   2   81.40640 39.06357 75.52357 81.40246 80.87598 86.74822
3:      3       2   2   82.64720 39.06357 75.52357 81.40246 80.87598 86.74822
4:      4       2   2   95.16112 39.06357 75.52357 81.40246 80.87598 86.74822
5:      5       2   1   90.75763 39.25293 75.57212 81.42169 80.88870 86.73704
6:      6       2   2   90.60751 39.06357 75.52357 81.40246 80.87598 86.74822
       Max. hba1c.mmol.mean
1: 105.2156        80.88017
2: 107.0541        80.88017
3: 107.0541        80.88017
4: 107.0541        80.88017
5: 105.2156        80.88017
6: 107.0541        80.88017</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1"></a>diabetes.dt[, hba1c.mmol.mean <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>] <span class="co"># Drops the hba1c.mmol.mean column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="special-symbols" class="level2"><h2 class="anchored" data-anchor-id="special-symbols">7.5 Special symbols</h2>
<p>The data.table package also defines special read-only symbols: <code>.SD</code>, <code>.N</code>, <code>.I</code>, <code>.GRP</code> and <code>.BY</code>. See R documentation in the <strong>Help tab</strong> for definitions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1"></a>diabetes.dt[.N] <span class="co"># Index the last row in the data table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   pat.id dm.type sex hba1c.mmol     Min.  1st Qu.   Median    Mean  3rd Qu.
1: 500000       2   1   85.84186 39.25293 75.57212 81.42169 80.8887 86.73704
       Max.
1: 105.2156</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1"></a><span class="co"># Number of rows in each group</span></span>
<span id="cb315-2"><a href="#cb315-2"></a>diabetes.dt[, .N, by<span class="ot">=</span>.(dm.type, sex)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex      N
1:       2   1 148261
2:       2   2 301561
3:       1   2  33579
4:       1   1  16599</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1"></a><span class="co"># Provide a row number for each type/sex</span></span>
<span id="cb317-2"><a href="#cb317-2"></a>diabetes.dt[, .(<span class="at">grp.num =</span> .GRP), by<span class="ot">=</span>.(dm.type, sex)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex grp.num
1:       2   1       1
2:       2   2       2
3:       1   2       3
4:       1   1       4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1"></a><span class="co"># Row number for first position of each group</span></span>
<span id="cb319-2"><a href="#cb319-2"></a>diabetes.dt[, .(<span class="at">group.pos =</span> .I[<span class="dv">1</span>]), by<span class="ot">=</span>.(dm.type, sex)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex group.pos
1:       2   1         1
2:       2   2         2
3:       1   2        28
4:       1   1        33</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1"></a><span class="co"># Complete rows for first position of each group</span></span>
<span id="cb321-2"><a href="#cb321-2"></a>diabetes.dt[, .SD[<span class="dv">1</span>], by<span class="ot">=</span>.(dm.type, sex)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dm.type sex pat.id hba1c.mmol     Min.  1st Qu.   Median     Mean  3rd Qu.
1:       2   1      1   88.97589 39.25293 75.57212 81.42169 80.88870 86.73704
2:       2   2      2   81.40640 39.06357 75.52357 81.40246 80.87598 86.74822
3:       1   2     28   83.91157 41.13940 75.60472 81.38569 80.85342 86.70759
4:       1   1     33   90.93050 40.04755 75.66419 81.40252 80.89027 86.65041
       Max.
1: 105.2156
2: 107.0541
3: 104.9365
4: 105.5992</code></pre>
</div>
</div>
</section><section id="chaining-with-pipes" class="level2"><h2 class="anchored" data-anchor-id="chaining-with-pipes">7.6 Chaining with pipes</h2>
<p>Data table results can be chained together in order that the result of one data table may be passed to the next. This takes the form <code>DT[][][]</code>.</p>
<p>Here, in the first row, we convert the mtcars built-in data frame to a data table, then we chain the output and only select two columns. We assign the result to the final data table <code>mtcars.cylmpg.dt</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1"></a>mtcars.cylmpg.dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(mtcars)[,<span class="fu">list</span>(cyl, mpg)]</span>
<span id="cb323-2"><a href="#cb323-2"></a>mtcars.cylmpg.dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    cyl  mpg
 1:   6 21.0
 2:   6 21.0
 3:   4 22.8
 4:   6 21.4
 5:   8 18.7
 6:   6 18.1
 7:   8 14.3
 8:   4 24.4
 9:   4 22.8
10:   6 19.2
11:   6 17.8
12:   8 16.4
13:   8 17.3
14:   8 15.2
15:   8 10.4
16:   8 10.4
17:   8 14.7
18:   4 32.4
19:   4 30.4
20:   4 33.9
21:   4 21.5
22:   8 15.5
23:   8 15.2
24:   8 13.3
25:   8 19.2
26:   4 27.3
27:   4 26.0
28:   4 30.4
29:   8 15.8
30:   6 19.7
31:   8 15.0
32:   4 21.4
    cyl  mpg</code></pre>
</div>
</div>
<p>Adding many chains may make your code very hard to follow. For this reason you might want to use the commonly known piping operator <code>%&gt;%</code> defined by the <code>magrittr</code> package. Alternatively, R offers a pipe operator <code>|&gt;</code> that has the same functionality from version 4.1 onwards. (Since <code>|&gt;</code> operator is not compatible with <code>data.table</code> package yet, we will solely use <code>%&gt;%</code> operator.) This operator uses the output of whatever precedes it as the input for whatever comes after. You can indicate exactly where the output needs to be applied as input using a <code>.</code>, otherwise it will assume that the output is to be used as the first argument of a function. Using this we can rewrite the above code the following way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb325-2"><a href="#cb325-2"></a></span>
<span id="cb325-3"><a href="#cb325-3"></a>mtcars.cylmpg.dt2 <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb325-4"><a href="#cb325-4"></a>                     <span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb325-5"><a href="#cb325-5"></a>                     .[ ,<span class="fu">list</span>(cyl, mpg)]</span>
<span id="cb325-6"><a href="#cb325-6"></a></span>
<span id="cb325-7"><a href="#cb325-7"></a><span class="co"># Check that both data tables are the same.</span></span>
<span id="cb325-8"><a href="#cb325-8"></a><span class="fu">all.equal</span>(mtcars.cylmpg.dt,mtcars.cylmpg.dt2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Suppose that we also wanted to create a column estimating the mean miles per gallon grouped by cylinder. We could do this using the assign by reference command <code>:=</code> the following way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1"></a>mtcars.cylmpg.dt2 <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb327-2"><a href="#cb327-2"></a>            <span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb327-3"><a href="#cb327-3"></a>            .[, <span class="fu">list</span>(cyl, mpg)] <span class="sc">%&gt;%</span></span>
<span id="cb327-4"><a href="#cb327-4"></a>            .[, cyl.avg.mpg <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>(mpg), by<span class="ot">=</span>cyl]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also chain the result to create columns showing the max and min results and finally show the results ordered by cylinder count.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1"></a>mtcars.cylmpg.dt2 <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="#cb328-2"></a>          <span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb328-3"><a href="#cb328-3"></a>          .[, <span class="fu">list</span>(cyl, mpg)] <span class="sc">%&gt;%</span></span>
<span id="cb328-4"><a href="#cb328-4"></a>          .[, cyl.avg.mpg <span class="sc">:</span><span class="er">=</span> <span class="fu">mean</span>(mpg), by<span class="ot">=</span>cyl] <span class="sc">%&gt;%</span></span>
<span id="cb328-5"><a href="#cb328-5"></a>          .[, <span class="fu">c</span>(<span class="st">"max.cyl.avg.mpg"</span>,</span>
<span id="cb328-6"><a href="#cb328-6"></a>                <span class="st">"min.cyl.avg.mpg"</span>) <span class="sc">:</span><span class="er">=</span></span>
<span id="cb328-7"><a href="#cb328-7"></a>              <span class="fu">list</span>(<span class="fu">max</span>(cyl.avg.mpg),</span>
<span id="cb328-8"><a href="#cb328-8"></a>                   <span class="fu">min</span>(cyl.avg.mpg))] <span class="sc">%&gt;%</span></span>
<span id="cb328-9"><a href="#cb328-9"></a>          .[<span class="fu">order</span>(cyl)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-7.1" class="level3"><h3 class="anchored" data-anchor-id="exercise-7.1">Exercise 7.1</h3>
<p>The built-in <code>nottem</code> time series object contains average air temperatures at Nottingham Castle in degrees Fahrenheit from 1920 to 1939. Documentation about time series objects can be found by searching ts in the Help tab. Note that the <code><a href="https://rdrr.io/r/stats/time.html">time()</a></code> function extracts dates from ts objects and returns a decimal number. The <code>date_decimal()</code> and <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> functions of the <code>lubridate</code> package can be used to convert these decimal numbers to years and months.</p>
<p>Convert <code>nottem</code> to a data table format. Hint: Use the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function to keep the most general class and convert a ts object to a numeric vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:data.table':

    dcast, melt</code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb332-2"><a href="#cb332-2"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: timechange</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:data.table':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use the <code><a href="https://rdrr.io/r/stats/reshape.html">reshape()</a></code> function (see R documentation) to reshape your data table to a <code>wide</code> format where the months are the variables with a temperature observation for each year. Remove any additional strings so that the column names show only the months. Using the assign by reference <code>:=</code> assignment operator, add a column called <code>summer.avg</code> and add the mean temperature of the summer months June to September for each year. Finally, using the assign by reference <code>:=</code> assignment operator, add a column called <code>june.decade.avg</code> which provides the average temperature in June from 1920 to 1929 and 1930 to 1939.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1"></a><span class="co"># Enter code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>